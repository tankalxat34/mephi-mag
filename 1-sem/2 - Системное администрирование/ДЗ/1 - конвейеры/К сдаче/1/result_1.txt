# Конвейер 1: Мониторинг процессов root

Принцип работы:

* ps aux — получает полный список процессов.
* grep '^root' — оставляет только строки, начинающиеся с root (процессы от root).
* awk '{print $2, $3, $11}' — выбирает нужные столбцы: PID, %CPU, COMMAND.
* sort -k2nr — сортирует по второму столбцу (%CPU) численно (-n) в обратном порядке (-r).
* Результат сохраняется в файл.

Цель: Создать отчёт о процессах root, отсортированный по загрузке CPU.

```bash
ps aux | \
    grep '^root' | \
    awk '{ print $2, $3, $11 }' | \
    sort -k2nr \
    > system_monitoring.txt
```


# Конвейер 2: Подсчёт строк в .txt файлах (<1 МБ)

Принцип работы:

* find ищет все .txt-файлы в домашней директории размером меньше 1 МБ (-1048576c = 1048576 байт).
* xargs wc -l — подсчитывает строки в каждом файле и выводит итоговую сумму в конце.
* tail -1 — берёт последнюю строку (где total).
* awk '{print $1}' — извлекает только число — общее количество строк.


Цель: Быстро получить общее число строк во всех небольших текстовых файлах пользователя.

```bash
find ~ -type f -name "*.txt" -size -1048576c | \
    xargs wc -l | \
    tail -1 | \
    awk '{ print $1 }'
```


# Конвейер 3: Анализ свободного места на дисках

Принцип работы:

* df -h — показывает использование дисков в человекочитаемом формате.
* awk 'NR > 1 {print $1, $4, $6}' — пропускает заголовок, выводит: Filesystem, Available, Mounted on.
* sort -k2 -h — сортирует по второму столбцу (Available) с учётом суффиксов (K, M, G).
* Сохраняет результат в файл.

Цель: Получить отсортированный по свободному месту список дисков — от наименьшего к наибольшему.

```bash
df -h | \
    awk 'NR > 1 {print $1, $4, $6}' | \
    sort -k2 -h \
    > disk_space_usage.txt
```


# Конвейер 4: Уникальные IP из логов с WARNING

Принцип работы:

* find ... -exec grep -h "WARNING" — рекурсивно ищет в логах строки с WARNING, без имён файлов.
* grep -Eo 'шаблон IP' — выделяет только IP-адреса из строк.
* awk с разделителем . — проверяет, что каждый октет ≤ 255 → фильтр валидных IPv4.
* sort | uniq — убирает дубликаты, оставляя уникальные IP.

Цель: Собрать все уникальные валидные IP-адреса, упомянутые в логах рядом с WARNING.

```bash
sudo -S find /var/log -type f -name "*.log" -exec grep -h "WARNING" {} + | \
    grep -Eo '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' | \
    awk -F. '$1 <= 255 && $2 <= 255 && $3 <= 255 && $4 <= 255' | \
    sort | uniq > unique_warnings_ips.txt
```


# Конвейер 5: Топ-5 самых больших директорий в /home

Принцип работы:

* du -sm /home/* — оценивает размер каждой поддиректории в /home в мегабайтах.
* awk '$1 > 100' — оставляет только те, что больше 100 МБ.
* sort -nr — сортирует по размеру по убыванию.
* head -n 5 — берёт первые 5 (самые большие).
* Последний awk — добавляет суффикс "M" для читаемости.

Цель: Найти и сохранить топ-5 самых объёмных пользовательских директорий (>100 МБ).

```bash
du -sm /home/* 2>/dev/null | \
    awk '$1 > 100' | \
    sort -nr | \
    head -n 5 | \
    awk '{print $1 "M", $2}' > largest_directories.txt
```