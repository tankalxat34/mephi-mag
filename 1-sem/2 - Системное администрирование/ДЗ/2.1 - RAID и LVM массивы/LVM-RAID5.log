alexander@pc-u-mephi01:~$
alexander@pc-u-mephi01:~$
alexander@pc-u-mephi01:~$ lsblk
NAME                      MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
sda                         8:0    0  100G  0 disk
├─sda1                      8:1    0    1M  0 part
├─sda2                      8:2    0    2G  0 part /boot
└─sda3                      8:3    0   98G  0 part
  └─ubuntu--vg-ubuntu--lv 252:0    0   49G  0 lvm  /
sdb                         8:16   0    1G  0 disk
sdc                         8:32   0    2G  0 disk
sdd                         8:48   0    3G  0 disk
sr0                        11:0    1 1024M  0 rom
alexander@pc-u-mephi01:~$ sudo mdadm --create --verbose /dev/md0 --level=5 --raid-devices=3 /dev/sdb /dev/sdc/dev/sdd
[sudo] password for alexander:
sudo: a password is required
alexander@pc-u-mephi01:~$ sudo mdadm --create --verbose /dev/md0 --level=5 --raid-devices=3 /dev/sdb /dev/sdc/dev/sdd
[sudo] password for alexander:
mdadm: layout defaults to left-symmetric
mdadm: layout defaults to left-symmetric
mdadm: chunk size defaults to 512K
mdadm: size set to 1046528K
mdadm: largest drive (/dev/sdd) exceeds size (1046528K) by more than 1%
Continue creating array? y
Continue creating array? (y/n) y
mdadm: Defaulting to version 1.2 metadata
mdadm: array /dev/md0 started.
alexander@pc-u-mephi01:~$ lsblk
NAME                      MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINTS
sda                         8:0    0  100G  0 disk
├─sda1                      8:1    0    1M  0 part
├─sda2                      8:2    0    2G  0 part  /boot
└─sda3                      8:3    0   98G  0 part
  └─ubuntu--vg-ubuntu--lv 252:0    0   49G  0 lvm   /
sdb                         8:16   0    1G  0 disk
└─md0                       9:0    0    2G  0 raid5
sdc                         8:32   0    2G  0 disk
└─md0                       9:0    0    2G  0 raid5
sdd                         8:48   0    3G  0 disk
└─md0                       9:0    0    2G  0 raid5
sr0                        11:0    1 1024M  0 rom
alexander@pc-u-mephi01:~$ cat /proc/mdstat
Personalities : [raid0] [raid1] [raid6] [raid5] [raid4] [raid10]
md0 : active raid5 sdd[3] sdc[1] sdb[0]
      2093056 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/3] [UUU]

unused devices: <none>
alexander@pc-u-mephi01:~$
alexander@pc-u-mephi01:~$ sudo pvcreate /dev/md0
  Physical volume "/dev/md0" successfully created.
alexander@pc-u-mephi01:~$ sudo pvs
  PV         VG        Fmt  Attr PSize   PFree
  /dev/md0             lvm2 ---   <2.00g <2.00g
  /dev/sda3  ubuntu-vg lvm2 a--  <98.00g 49.00g
alexander@pc-u-mephi01:~$
alexander@pc-u-mephi01:~$
alexander@pc-u-mephi01:~$ sudo vgcreate vg_data /dev/md0
  Volume group "vg_data" successfully created
alexander@pc-u-mephi01:~$ sudo vgs
  VG        #PV #LV #SN Attr   VSize   VFree
  ubuntu-vg   1   1   0 wz--n- <98.00g 49.00g
  vg_data     1   0   0 wz--n-   1.99g  1.99g
alexander@pc-u-mephi01:~$ sudo lvcreate -l 100%FREE -n lv_storage vg_data
  Logical volume "lv_storage" created.
alexander@pc-u-mephi01:~$ sudo lvs
  LV         VG        Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
  ubuntu-lv  ubuntu-vg -wi-ao---- <49.00g
  lv_storage vg_data   -wi-a-----   1.99g
alexander@pc-u-mephi01:~$ uname -a
Linux pc-u-mephi01 6.8.0-85-generic #85-Ubuntu SMP PREEMPT_DYNAMIC Thu Sep 18 15:26:59 UTC 2025 x86_64 x86_64x86_64 GNU/Linux
alexander@pc-u-mephi01:~$ uname --help
Usage: uname [OPTION]...
Print certain system information.  With no OPTION, same as -s.

  -a, --all                print all information, in the following order,
                             except omit -p and -i if unknown:
  -s, --kernel-name        print the kernel name
  -n, --nodename           print the network node hostname
  -r, --kernel-release     print the kernel release
  -v, --kernel-version     print the kernel version
  -m, --machine            print the machine hardware name
  -p, --processor          print the processor type (non-portable)
  -i, --hardware-platform  print the hardware platform (non-portable)
  -o, --operating-system   print the operating system
      --help        display this help and exit
      --version     output version information and exit

GNU coreutils online help: <https://www.gnu.org/software/coreutils/>
Full documentation <https://www.gnu.org/software/coreutils/uname>
or available locally via: info '(coreutils) uname invocation'
alexander@pc-u-mephi01:~$ uname --processor
x86_64
alexander@pc-u-mephi01:~$ osname
osname: command not found
alexander@pc-u-mephi01:~$ sudo mkfs.ext4 /dev/vg_data/lv_storage
mke2fs 1.47.0 (5-Feb-2023)
Creating filesystem with 522240 4k blocks and 130560 inodes
Filesystem UUID: 68a3a2b7-3fd9-4fa4-95c2-2680de9ac792
Superblock backups stored on blocks:
        32768, 98304, 163840, 229376, 294912

Allocating group tables: done
Writing inode tables: done
Creating journal (8192 blocks): done
Writing superblocks and filesystem accounting information: done

alexander@pc-u-mephi01:~$ sudo mkdir -p /mnt/storage
alexander@pc-u-mephi01:~$ sudo mount /dev/vg_data/lv_storage /mnt/storage
alexander@pc-u-mephi01:~$ df -h /mnt/storage
Filesystem                      Size  Used Avail Use% Mounted on
/dev/mapper/vg_data-lv_storage  2.0G   24K  1.9G   1% /mnt/storage
alexander@pc-u-mephi01:~$ lsblk
NAME                      MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINTS
sda                         8:0    0  100G  0 disk
├─sda1                      8:1    0    1M  0 part
├─sda2                      8:2    0    2G  0 part  /boot
└─sda3                      8:3    0   98G  0 part
  └─ubuntu--vg-ubuntu--lv 252:0    0   49G  0 lvm   /
sdb                         8:16   0    1G  0 disk
└─md0                       9:0    0    2G  0 raid5
  └─vg_data-lv_storage    252:1    0    2G  0 lvm   /mnt/storage
sdc                         8:32   0    2G  0 disk
└─md0                       9:0    0    2G  0 raid5
  └─vg_data-lv_storage    252:1    0    2G  0 lvm   /mnt/storage
sdd                         8:48   0    3G  0 disk
└─md0                       9:0    0    2G  0 raid5
  └─vg_data-lv_storage    252:1    0    2G  0 lvm   /mnt/storage
sr0                        11:0    1 1024M  0 rom
alexander@pc-u-mephi01:~$
alexander@pc-u-mephi01:~$
alexander@pc-u-mephi01:~$ sudo nano /etc/fstab
alexander@pc-u-mephi01:~$ ls /dev
autofs           fuse          midi    sg1       tty18  tty38  tty58      ttyS19     udmabuf      vcsu2
block            hidraw0       mqueue  sg2       tty19  tty39  tty59      ttyS2      uhid         vcsu3
bsg              hpet          net     sg3       tty2   tty4   tty6       ttyS20     uinput       vcsu4
btrfs-control    hugepages     null    sg4       tty20  tty40  tty60      ttyS21     urandom      vcsu5
bus              hwrng         nvram   shm       tty21  tty41  tty61      ttyS22     userfaultfd  vcsu6
cdrom            initctl       port    snapshot  tty22  tty42  tty62      ttyS23     userio       vfio
char             input         ppp     snd       tty23  tty43  tty63      ttyS24     vcs          vga_arbiter
console          kmsg          psaux   sr0       tty24  tty44  tty7       ttyS25     vcs1         vg_data
core             log           ptmx    stderr    tty25  tty45  tty8       ttyS26     vcs2         vhci
cpu              loop0         pts     stdin     tty26  tty46  tty9       ttyS27     vcs3         vhost-net
cpu_dma_latency  loop1         random  stdout    tty27  tty47  ttyprintk  ttyS28     vcs4         vhost-vsock
cuse             loop2         rfkill  tty       tty28  tty48  ttyS0      ttyS29     vcs5         vmci
disk             loop3         rtc     tty0      tty29  tty49  ttyS1      ttyS3      vcs6         vsock
dm-0             loop4         rtc0    tty1      tty3   tty5   ttyS10     ttyS30     vcsa         zero
dm-1             loop5         sda     tty10     tty30  tty50  ttyS11     ttyS31     vcsa1        zfs
dma_heap         loop6         sda1    tty11     tty31  tty51  ttyS12     ttyS4      vcsa2
dmmidi           loop7         sda2    tty12     tty32  tty52  ttyS13     ttyS5      vcsa3
dri              loop-control  sda3    tty13     tty33  tty53  ttyS14     ttyS6      vcsa4
ecryptfs         mapper        sdb     tty14     tty34  tty54  ttyS15     ttyS7      vcsa5
fb0              mcelog        sdc     tty15     tty35  tty55  ttyS16     ttyS8      vcsa6
fd               md0           sdd     tty16     tty36  tty56  ttyS17     ttyS9      vcsu
full             mem           sg0     tty17     tty37  tty57  ttyS18     ubuntu-vg  vcsu1
alexander@pc-u-mephi01:~$ cd /dev
alexander@pc-u-mephi01:/dev$ ls
autofs           fuse          midi    sg1       tty18  tty38  tty58      ttyS19     udmabuf      vcsu2
block            hidraw0       mqueue  sg2       tty19  tty39  tty59      ttyS2      uhid         vcsu3
bsg              hpet          net     sg3       tty2   tty4   tty6       ttyS20     uinput       vcsu4
btrfs-control    hugepages     null    sg4       tty20  tty40  tty60      ttyS21     urandom      vcsu5
bus              hwrng         nvram   shm       tty21  tty41  tty61      ttyS22     userfaultfd  vcsu6
cdrom            initctl       port    snapshot  tty22  tty42  tty62      ttyS23     userio       vfio
char             input         ppp     snd       tty23  tty43  tty63      ttyS24     vcs          vga_arbiter
console          kmsg          psaux   sr0       tty24  tty44  tty7       ttyS25     vcs1         vg_data
core             log           ptmx    stderr    tty25  tty45  tty8       ttyS26     vcs2         vhci
cpu              loop0         pts     stdin     tty26  tty46  tty9       ttyS27     vcs3         vhost-net
cpu_dma_latency  loop1         random  stdout    tty27  tty47  ttyprintk  ttyS28     vcs4         vhost-vsock
cuse             loop2         rfkill  tty       tty28  tty48  ttyS0      ttyS29     vcs5         vmci
disk             loop3         rtc     tty0      tty29  tty49  ttyS1      ttyS3      vcs6         vsock
dm-0             loop4         rtc0    tty1      tty3   tty5   ttyS10     ttyS30     vcsa         zero
dm-1             loop5         sda     tty10     tty30  tty50  ttyS11     ttyS31     vcsa1        zfs
dma_heap         loop6         sda1    tty11     tty31  tty51  ttyS12     ttyS4      vcsa2
dmmidi           loop7         sda2    tty12     tty32  tty52  ttyS13     ttyS5      vcsa3
dri              loop-control  sda3    tty13     tty33  tty53  ttyS14     ttyS6      vcsa4
ecryptfs         mapper        sdb     tty14     tty34  tty54  ttyS15     ttyS7      vcsa5
fb0              mcelog        sdc     tty15     tty35  tty55  ttyS16     ttyS8      vcsa6
fd               md0           sdd     tty16     tty36  tty56  ttyS17     ttyS9      vcsu
full             mem           sg0     tty17     tty37  tty57  ttyS18     ubuntu-vg  vcsu1
alexander@pc-u-mephi01:/dev$ cd ubuntu-vg/
alexander@pc-u-mephi01:/dev/ubuntu-vg$ ls
ubuntu-lv
alexander@pc-u-mephi01:/dev/ubuntu-vg$ ls -l
total 0
lrwxrwxrwx 1 root root 7 Oct  4 08:35 ubuntu-lv -> ../dm-0
alexander@pc-u-mephi01:/dev/ubuntu-vg$ cd
alexander@pc-u-mephi01:~$ cd /dev
alexander@pc-u-mephi01:/dev$ ls
autofs           fuse          midi    sg1       tty18  tty38  tty58      ttyS19     udmabuf      vcsu2
block            hidraw0       mqueue  sg2       tty19  tty39  tty59      ttyS2      uhid         vcsu3
bsg              hpet          net     sg3       tty2   tty4   tty6       ttyS20     uinput       vcsu4
btrfs-control    hugepages     null    sg4       tty20  tty40  tty60      ttyS21     urandom      vcsu5
bus              hwrng         nvram   shm       tty21  tty41  tty61      ttyS22     userfaultfd  vcsu6
cdrom            initctl       port    snapshot  tty22  tty42  tty62      ttyS23     userio       vfio
char             input         ppp     snd       tty23  tty43  tty63      ttyS24     vcs          vga_arbiter
console          kmsg          psaux   sr0       tty24  tty44  tty7       ttyS25     vcs1         vg_data
core             log           ptmx    stderr    tty25  tty45  tty8       ttyS26     vcs2         vhci
cpu              loop0         pts     stdin     tty26  tty46  tty9       ttyS27     vcs3         vhost-net
cpu_dma_latency  loop1         random  stdout    tty27  tty47  ttyprintk  ttyS28     vcs4         vhost-vsock
cuse             loop2         rfkill  tty       tty28  tty48  ttyS0      ttyS29     vcs5         vmci
disk             loop3         rtc     tty0      tty29  tty49  ttyS1      ttyS3      vcs6         vsock
dm-0             loop4         rtc0    tty1      tty3   tty5   ttyS10     ttyS30     vcsa         zero
dm-1             loop5         sda     tty10     tty30  tty50  ttyS11     ttyS31     vcsa1        zfs
dma_heap         loop6         sda1    tty11     tty31  tty51  ttyS12     ttyS4      vcsa2
dmmidi           loop7         sda2    tty12     tty32  tty52  ttyS13     ttyS5      vcsa3
dri              loop-control  sda3    tty13     tty33  tty53  ttyS14     ttyS6      vcsa4
ecryptfs         mapper        sdb     tty14     tty34  tty54  ttyS15     ttyS7      vcsa5
fb0              mcelog        sdc     tty15     tty35  tty55  ttyS16     ttyS8      vcsa6
fd               md0           sdd     tty16     tty36  tty56  ttyS17     ttyS9      vcsu
full             mem           sg0     tty17     tty37  tty57  ttyS18     ubuntu-vg  vcsu1
alexander@pc-u-mephi01:/dev$ cd vg_data/
alexander@pc-u-mephi01:/dev/vg_data$ sudo nano /etc/fstab
alexander@pc-u-mephi01:/dev/vg_data$ cd
alexander@pc-u-mephi01:~$ sudo cat /etc/fstab
# /etc/fstab: static file system information.
#
# Use 'blkid' to print the universally unique identifier for a
# device; this may be used with UUID= as a more robust way to name devices
# that works even if disks are added and removed. See fstab(5).
#
# <file system> <mount point>   <type>  <options>       <dump>  <pass>
# / was on /dev/ubuntu-vg/ubuntu-lv during curtin installation
/dev/disk/by-id/dm-uuid-LVM-tPuCK1VrVo0cdhWimPrwpVe6tmu1rIpP7tfYVa4MQTzHJBhyz6Z9Vh9nLR4UblB4 / ext4 defaults 0 1
# /boot was on /dev/sda2 during curtin installation
/dev/disk/by-uuid/e01963b4-73bc-4359-809e-ff11ace198d5 /boot ext4 defaults 0 1
/swap.img       none    swap    sw      0       0
/dev/vg_data/lv_storage /mnt/storage    ext4    defaults        0       0
alexander@pc-u-mephi01:~$ lsblk
NAME                      MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINTS
sda                         8:0    0  100G  0 disk
├─sda1                      8:1    0    1M  0 part
├─sda2                      8:2    0    2G  0 part  /boot
└─sda3                      8:3    0   98G  0 part
  └─ubuntu--vg-ubuntu--lv 252:0    0   49G  0 lvm   /
sdb                         8:16   0    1G  0 disk
└─md0                       9:0    0    2G  0 raid5
  └─vg_data-lv_storage    252:1    0    2G  0 lvm   /mnt/storage
sdc                         8:32   0    2G  0 disk
└─md0                       9:0    0    2G  0 raid5
  └─vg_data-lv_storage    252:1    0    2G  0 lvm   /mnt/storage
sdd                         8:48   0    3G  0 disk
└─md0                       9:0    0    2G  0 raid5
  └─vg_data-lv_storage    252:1    0    2G  0 lvm   /mnt/storage
sr0                        11:0    1 1024M  0 rom
alexander@pc-u-mephi01:~$
alexander@pc-u-mephi01:~$
alexander@pc-u-mephi01:~$ cat /proc/mdstat
Personalities : [raid0] [raid1] [raid6] [raid5] [raid4] [raid10]
md0 : active raid5 sdd[3] sdc[1] sdb[0]
      2093056 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/3] [UUU]

unused devices: <none>
alexander@pc-u-mephi01:~$ sudo mdadm --fail /dev/md0 /dev/sdb
mdadm: set /dev/sdb faulty in /dev/md0
alexander@pc-u-mephi01:~$ cat /proc/mdstat
Personalities : [raid0] [raid1] [raid6] [raid5] [raid4] [raid10]
md0 : active raid5 sdd[3] sdc[1] sdb[0](F)
      2093056 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/2] [_UU]

unused devices: <none>
alexander@pc-u-mephi01:~$ sudo mdadm --remove /dev/md0 /dev/sdb
mdadm: hot removed /dev/sdb from /dev/md0
alexander@pc-u-mephi01:~$ cat /proc/mdstat
Personalities : [raid0] [raid1] [raid6] [raid5] [raid4] [raid10]
md0 : active raid5 sdd[3] sdc[1]
      2093056 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/2] [_UU]

unused devices: <none>
alexander@pc-u-mephi01:~$ echo "Тест после отказа" | sudo tee /mnt/storage/test_after_failure.txt
Тест после отказа
alexander@pc-u-mephi01:~$ cat /mnt/storage/test_after_failure.txt
Тест после отказа
alexander@pc-u-mephi01:~$
alexander@pc-u-mephi01:~$
alexander@pc-u-mephi01:~$ sudo mdadm --add /dev/md0 /dev/sdb
mdadm: added /dev/sdb
alexander@pc-u-mephi01:~$ watch -n 1 cat /proc/mdstat
alexander@pc-u-mephi01:~$ watch -n 1 cat /proc/mdstat
alexander@pc-u-mephi01:~$ cat /proc/mdstat
Personalities : [raid0] [raid1] [raid6] [raid5] [raid4] [raid10]
md0 : active raid5 sdb[4] sdd[3] sdc[1]
      2093056 blocks super 1.2 level 5, 512k chunk, algorithm 2 [3/3] [UUU]

unused devices: <none>
alexander@pc-u-mephi01:~$ cat /mnt/storage/test_after_failure.txt
Тест после отказа
alexander@pc-u-mephi01:~$ sudo mdadm --examine /dev/sdb
/dev/sdb:
          Magic : a92b4efc
        Version : 1.2
    Feature Map : 0x0
     Array UUID : dec93e34:1f2fcc32:03e49168:fe3f7d6b
           Name : pc-u-mephi01:0  (local to host pc-u-mephi01)
  Creation Time : Sat Oct  4 08:51:08 2025
     Raid Level : raid5
   Raid Devices : 3

 Avail Dev Size : 2093056 sectors (1022.00 MiB 1071.64 MB)
     Array Size : 2093056 KiB (2044.00 MiB 2143.29 MB)
    Data Offset : 4096 sectors
   Super Offset : 8 sectors
   Unused Space : before=4016 sectors, after=0 sectors
          State : clean
    Device UUID : ad6b2649:7eca5d47:ea386e36:7b1e6f46

    Update Time : Sat Oct  4 09:36:02 2025
  Bad Block Log : 512 entries available at offset 16 sectors
       Checksum : da782323 - correct
         Events : 50

         Layout : left-symmetric
     Chunk Size : 512K

   Device Role : Active device 0
   Array State : AAA ('A' == active, '.' == missing, 'R' == replacing)
alexander@pc-u-mephi01:~$
