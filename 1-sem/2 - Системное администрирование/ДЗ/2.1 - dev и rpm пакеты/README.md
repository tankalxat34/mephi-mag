# Лог выполнения задания

## RPM (CensOS 10 Stream (x86_64))
Linux lptp-s-cexp01 6.12.0-134.el10.x86_64 #1 SMP PREEMPT_DYNAMIC Wed Sep 24 15:01:11 UTC 2025 x86_64 GNU/Linux

### 15:57 02.10.2025 - утилита easy-rsa вместо gpg.

> [!NOTE]
> Не работает gpg? Зацикливается диалог на этапе ввода мастер-фразы? Возможное решение этой проблемы: `rm -rf ~/.gnupg`
>
> Ошибка с непонятным символом `$'\r'`? Этот символ заносится в файл виндой. Чтобы избавиться от него внутри Linux надо выполнить преобразование файла из формата DOS в формат Unix: `dos2unix mephi-script1.spec`

Фиксируется непреодолимая ошибка `gpg2 --gen-keys`. Диалог ввода мастер-фразы зацикливается. Продолжить выполнение скрипта по созданию ключа и подписанию пакета невозможно. В связи с этим далее используется пакет `easy-rsa`. В Ubuntu он доступен по команде 

В ОС установлен пакет `easy-rsa-3.2.4-1.el10_2.noarch.rpm` (свободно распространяемая функциональная часть ПО OpenVPN).

По умолчанию активный скрипт пакета устанавливается в `/usr/share/easy-rsa/3.2.4`. Взаимодействие со скриптом происходит командой `./easyrsa`. В этом расположении необходимо создать файл `vars` со следующим содержимым:
```bash
set_var EASYRSA_REQ_COUNTRY "RU"
set_var EASYRSA_REQ_PROVINCE "Moscow"
set_var EASYRSA_REQ_CITY "Moscow"
set_var EASYRSA_REQ_ORG "My Organization"
set_var EASYRSA_REQ_OU "IT Department"
set_var EASYRSA_REQ_CN "RPM Signing CA"
set_var EASYRSA_KEY_SIZE 2048
```

Файл `vars` позволяет задать все необходимые значения для нашего сертификата и подписей, чтобы можно было без лишних вопросов сделать серт, ключ или другие сущности.

В расположении `/etc/pki/rpm-gpg/` создаются публичные ключи.

Далее команды ниже выполняются в этом же расположении `/usr/share/easy-rsa/3.2.4`:
```bash
# инициализируем pki
./easyrsa init-pki

# создание корневого сертификата. от него будем осуществлять подписание
./easyrsa build-ca

# создаем запрос на генерацию ключа rpm-signer, не устанавливать пароль на клиентский сертификат
# если не указать nopass - при каждом использовании сертификата будет запрашиваться пароль
./easyrsa gen-req rpm-signer nopass

```